{"version":3,"sources":["@wordpress/components/src/navigation/menu/menu-title-search.js"],"names":["filter","useEffect","useRef","Icon","closeSmall","search","searchIcon","__","_n","sprintf","ESCAPE","Button","VisuallyHidden","withSpokenMessages","useNavigationMenuContext","useNavigationContext","MenuTitleSearchUI","SEARCH_FOCUS_DELAY","MenuTitleSearch","debouncedSpeak","onCloseSearch","onSearch","title","navigationTree","items","menu","inputRef","delayedFocus","setTimeout","current","focus","clearTimeout","count","length","resultsFoundMessage","onClose","onKeyDown","event","keyCode","defaultPrevented","preventDefault","menuTitleId","inputId","placeholder","target","value"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { filter } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { useEffect, useRef } from '@wordpress/element';\nimport { Icon, closeSmall, search as searchIcon } from '@wordpress/icons';\nimport { __, _n, sprintf } from '@wordpress/i18n';\nimport { ESCAPE } from '@wordpress/keycodes';\n\n/**\n * Internal dependencies\n */\nimport Button from '../../button';\nimport { VisuallyHidden } from '../../visually-hidden';\nimport withSpokenMessages from '../../higher-order/with-spoken-messages';\nimport { useNavigationMenuContext } from './context';\nimport { useNavigationContext } from '../context';\nimport { MenuTitleSearchUI } from '../styles/navigation-styles';\nimport { SEARCH_FOCUS_DELAY } from '../constants';\n\nfunction MenuTitleSearch( {\n\tdebouncedSpeak,\n\tonCloseSearch,\n\tonSearch,\n\tsearch,\n\ttitle,\n} ) {\n\tconst {\n\t\tnavigationTree: { items },\n\t} = useNavigationContext();\n\tconst { menu } = useNavigationMenuContext();\n\tconst inputRef = useRef();\n\n\t// Wait for the slide-in animation to complete before autofocusing the input.\n\t// This prevents scrolling to the input during the animation.\n\tuseEffect( () => {\n\t\tconst delayedFocus = setTimeout( () => {\n\t\t\tinputRef.current.focus();\n\t\t}, SEARCH_FOCUS_DELAY );\n\n\t\treturn () => {\n\t\t\tclearTimeout( delayedFocus );\n\t\t};\n\t}, [] );\n\n\tuseEffect( () => {\n\t\tif ( ! search ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst count = filter( items, '_isVisible' ).length;\n\t\tconst resultsFoundMessage = sprintf(\n\t\t\t/* translators: %d: number of results. */\n\t\t\t_n( '%d result found.', '%d results found.', count ),\n\t\t\tcount\n\t\t);\n\t\tdebouncedSpeak( resultsFoundMessage );\n\t}, [ items, search ] );\n\n\tconst onClose = () => {\n\t\tonSearch( '' );\n\t\tonCloseSearch();\n\t};\n\n\tfunction onKeyDown( event ) {\n\t\tif ( event.keyCode === ESCAPE && ! event.defaultPrevented ) {\n\t\t\tevent.preventDefault();\n\t\t\tonClose();\n\t\t}\n\t}\n\n\tconst menuTitleId = `components-navigation__menu-title-${ menu }`;\n\tconst inputId = `components-navigation__menu-title-search-${ menu }`;\n\t/* translators: placeholder for menu search box. %s: menu title */\n\tconst placeholder = sprintf( __( 'Search in %s' ), title );\n\n\treturn (\n\t\t<MenuTitleSearchUI className=\"components-navigation__menu-title-search\">\n\t\t\t<Icon icon={ searchIcon } />\n\n\t\t\t<VisuallyHidden as=\"label\" htmlFor={ inputId } id={ menuTitleId }>\n\t\t\t\t{ placeholder }\n\t\t\t</VisuallyHidden>\n\n\t\t\t<input\n\t\t\t\tautoComplete=\"off\"\n\t\t\t\tclassName=\"components-text-control__input\"\n\t\t\t\tid={ inputId }\n\t\t\t\tonChange={ ( event ) => onSearch( event.target.value ) }\n\t\t\t\tonKeyDown={ onKeyDown }\n\t\t\t\tplaceholder={ placeholder }\n\t\t\t\tref={ inputRef }\n\t\t\t\ttype=\"search\"\n\t\t\t\tvalue={ search }\n\t\t\t/>\n\n\t\t\t<Button\n\t\t\t\tisSmall\n\t\t\t\tvariant=\"tertiary\"\n\t\t\t\tlabel={ __( 'Close search' ) }\n\t\t\t\tonClick={ onClose }\n\t\t\t>\n\t\t\t\t<Icon icon={ closeSmall } />\n\t\t\t</Button>\n\t\t</MenuTitleSearchUI>\n\t);\n}\n\nexport default withSpokenMessages( MenuTitleSearch );\n"]}
{"version":3,"sources":["@wordpress/components/src/mobile/audio-player/index.native.js"],"names":["isIOS","Platform","OS","Player","getStylesFromColorScheme","isUploadInProgress","isUploadFailed","attributes","isSelected","id","src","paused","setPaused","onPressListen","player","presentFullscreenPlayer","Linking","canOpenURL","then","supported","Alert","alert","openURL","catch","containerStyle","styles","container","containerDark","iconStyle","icon","iconDark","iconDisabledStyle","iconDisabled","iconDisabledDark","isDisabled","finalIconStyle","iconContainerStyle","iconContainer","iconContainerDark","titleContainerStyle","titleContainer","titleContainerIOS","titleContainerAndroid","titleStyle","title","titleDark","uploadFailedStyle","uploadFailed","uploadFailedDark","subtitleStyle","subtitle","subtitleDark","finalSubtitleStyle","buttonBackgroundStyle","buttonBackground","buttonBackgroundDark","extension","result","getSubtitleValue","onAudioUploadCancelDialog","audio","subtitleContainer","warning","errorIcon","buttonText","uri","ref"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport {\n\tText,\n\tTouchableWithoutFeedback,\n\tLinking,\n\tAlert,\n\tPlatform,\n} from 'react-native';\nimport { default as VideoPlayer } from 'react-native-video';\n\n/**\n * WordPress dependencies\n */\nimport { View } from '@wordpress/primitives';\nimport { Icon } from '@wordpress/components';\nimport { withPreferredColorScheme } from '@wordpress/compose';\nimport { __ } from '@wordpress/i18n';\nimport { audio, warning } from '@wordpress/icons';\nimport {\n\trequestImageFailedRetryDialog,\n\trequestImageUploadCancelDialog,\n} from '@wordpress/react-native-bridge';\nimport { getProtocol } from '@wordpress/url';\nimport { useState } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport styles from './styles.scss';\nimport { parseAudioUrl } from './audio-url-parser.native';\n\nconst isIOS = Platform.OS === 'ios';\n\nfunction Player( {\n\tgetStylesFromColorScheme,\n\tisUploadInProgress,\n\tisUploadFailed,\n\tattributes,\n\tisSelected,\n} ) {\n\tconst { id, src } = attributes;\n\tconst [ paused, setPaused ] = useState( true );\n\n\tconst onPressListen = () => {\n\t\tif ( src ) {\n\t\t\tif ( isIOS && this.player ) {\n\t\t\t\tthis.player.presentFullscreenPlayer();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tLinking.canOpenURL( src )\n\t\t\t\t.then( ( supported ) => {\n\t\t\t\t\tif ( ! supported ) {\n\t\t\t\t\t\tAlert.alert(\n\t\t\t\t\t\t\t__( 'Problem opening the audio' ),\n\t\t\t\t\t\t\t__( 'No application can handle this request.' )\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn Linking.openURL( src );\n\t\t\t\t\t}\n\t\t\t\t} )\n\t\t\t\t.catch( () => {\n\t\t\t\t\tAlert.alert(\n\t\t\t\t\t\t__( 'Problem opening the audio' ),\n\t\t\t\t\t\t__( 'An unknown error occurred. Please try again.' )\n\t\t\t\t\t);\n\t\t\t\t} );\n\t\t}\n\t};\n\n\tconst containerStyle = getStylesFromColorScheme(\n\t\tstyles.container,\n\t\tstyles.containerDark\n\t);\n\n\tconst iconStyle = getStylesFromColorScheme( styles.icon, styles.iconDark );\n\n\tconst iconDisabledStyle = getStylesFromColorScheme(\n\t\tstyles.iconDisabled,\n\t\tstyles.iconDisabledDark\n\t);\n\n\tconst isDisabled = isUploadFailed || isUploadInProgress;\n\n\tconst finalIconStyle = {\n\t\t...iconStyle,\n\t\t...( isDisabled && iconDisabledStyle ),\n\t};\n\n\tconst iconContainerStyle = getStylesFromColorScheme(\n\t\tstyles.iconContainer,\n\t\tstyles.iconContainerDark\n\t);\n\n\tconst titleContainerStyle = {\n\t\t...styles.titleContainer,\n\t\t...( isIOS ? styles.titleContainerIOS : styles.titleContainerAndroid ),\n\t};\n\n\tconst titleStyle = getStylesFromColorScheme(\n\t\tstyles.title,\n\t\tstyles.titleDark\n\t);\n\n\tconst uploadFailedStyle = getStylesFromColorScheme(\n\t\tstyles.uploadFailed,\n\t\tstyles.uploadFailedDark\n\t);\n\n\tconst subtitleStyle = getStylesFromColorScheme(\n\t\tstyles.subtitle,\n\t\tstyles.subtitleDark\n\t);\n\n\tconst finalSubtitleStyle = {\n\t\t...subtitleStyle,\n\t\t...( isUploadFailed && uploadFailedStyle ),\n\t};\n\n\tconst buttonBackgroundStyle = getStylesFromColorScheme(\n\t\tstyles.buttonBackground,\n\t\tstyles.buttonBackgroundDark\n\t);\n\n\tlet title = '';\n\tlet extension = '';\n\n\tif ( src ) {\n\t\tconst result = parseAudioUrl( src );\n\t\textension = result.extension;\n\t\ttitle = result.title;\n\t}\n\n\tconst getSubtitleValue = () => {\n\t\tif ( isUploadInProgress ) {\n\t\t\treturn __( 'Uploadingâ€¦' );\n\t\t}\n\t\tif ( isUploadFailed ) {\n\t\t\treturn __( 'Failed to insert audio file. Please tap for options.' );\n\t\t}\n\t\treturn (\n\t\t\textension +\n\t\t\t// translators: displays audio file extension. e.g. MP3 audio file\n\t\t\t__( 'audio file' )\n\t\t);\n\t};\n\n\tfunction onAudioUploadCancelDialog() {\n\t\tif ( isUploadInProgress ) {\n\t\t\trequestImageUploadCancelDialog( id );\n\t\t} else if ( id && getProtocol( src ) === 'file:' ) {\n\t\t\trequestImageFailedRetryDialog( id );\n\t\t}\n\t}\n\n\treturn (\n\t\t<TouchableWithoutFeedback\n\t\t\taccessible={ ! isSelected }\n\t\t\tdisabled={ ! isSelected }\n\t\t\tonPress={ onAudioUploadCancelDialog }\n\t\t>\n\t\t\t<View style={ containerStyle }>\n\t\t\t\t<View style={ iconContainerStyle }>\n\t\t\t\t\t<Icon icon={ audio } style={ finalIconStyle } size={ 24 } />\n\t\t\t\t</View>\n\t\t\t\t<View style={ titleContainerStyle }>\n\t\t\t\t\t<Text style={ titleStyle }>{ title }</Text>\n\t\t\t\t\t<View style={ styles.subtitleContainer }>\n\t\t\t\t\t\t{ isUploadFailed && (\n\t\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\t\ticon={ warning }\n\t\t\t\t\t\t\t\tstyle={ {\n\t\t\t\t\t\t\t\t\t...styles.errorIcon,\n\t\t\t\t\t\t\t\t\t...uploadFailedStyle,\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\tsize={ 16 }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) }\n\t\t\t\t\t\t<Text style={ finalSubtitleStyle }>\n\t\t\t\t\t\t\t{ getSubtitleValue() }\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t</View>\n\t\t\t\t</View>\n\t\t\t\t{ ! isDisabled && (\n\t\t\t\t\t<TouchableWithoutFeedback\n\t\t\t\t\t\taccessibilityLabel={ __( 'Audio Player' ) }\n\t\t\t\t\t\taccessibilityRole={ 'button' }\n\t\t\t\t\t\taccessibilityHint={ __(\n\t\t\t\t\t\t\t'Double tap to listen the audio file'\n\t\t\t\t\t\t) }\n\t\t\t\t\t\tonPress={ onPressListen }\n\t\t\t\t\t>\n\t\t\t\t\t\t<View style={ buttonBackgroundStyle }>\n\t\t\t\t\t\t\t<Text style={ styles.buttonText }>\n\t\t\t\t\t\t\t\t{ __( 'OPEN' ) }\n\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t</View>\n\t\t\t\t\t</TouchableWithoutFeedback>\n\t\t\t\t) }\n\t\t\t\t{ isIOS && (\n\t\t\t\t\t<VideoPlayer\n\t\t\t\t\t\tsource={ { uri: src } }\n\t\t\t\t\t\tpaused={ paused }\n\t\t\t\t\t\tref={ ( ref ) => {\n\t\t\t\t\t\t\tthis.player = ref;\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tcontrols={ false }\n\t\t\t\t\t\tignoreSilentSwitch={ 'ignore' }\n\t\t\t\t\t\tonFullscreenPlayerWillPresent={ () => {\n\t\t\t\t\t\t\tsetPaused( false );\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tonFullscreenPlayerDidDismiss={ () => {\n\t\t\t\t\t\t\tsetPaused( true );\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t</View>\n\t\t</TouchableWithoutFeedback>\n\t);\n}\n\nexport default withPreferredColorScheme( Player );\n"]}
{"version":3,"sources":["@wordpress/rich-text/src/component/use-boundary-style.js"],"names":["useBoundaryStyle","record","ref","activeFormats","current","length","boundarySelector","element","querySelector","ownerDocument","defaultView","computedStyle","getComputedStyle","newColor","color","replace","selector","rule","style","globalStyleId","globalStyle","getElementById","createElement","id","head","appendChild","innerHTML"],"mappings":";;;;;;;AAGA;;AAHA;AACA;AACA;;AAGA;AACA;AACA;AACA;AACO,SAASA,gBAAT,CAA2B;AAAEC,EAAAA;AAAF,CAA3B,EAAwC;AAC9C,QAAMC,GAAG,GAAG,sBAAZ;AACA,QAAM;AAAEC,IAAAA,aAAa,GAAG;AAAlB,MAAyBF,MAAM,CAACG,OAAtC;AACA,0BAAW,MAAM;AAChB;AACA;AACA,QAAK,CAAED,aAAF,IAAmB,CAAEA,aAAa,CAACE,MAAxC,EAAiD;AAChD;AACA;;AAED,UAAMC,gBAAgB,GAAG,mCAAzB;AACA,UAAMC,OAAO,GAAGL,GAAG,CAACE,OAAJ,CAAYI,aAAZ,CAA2BF,gBAA3B,CAAhB;;AAEA,QAAK,CAAEC,OAAP,EAAiB;AAChB;AACA;;AAED,UAAM;AAAEE,MAAAA;AAAF,QAAoBF,OAA1B;AACA,UAAM;AAAEG,MAAAA;AAAF,QAAkBD,aAAxB;AACA,UAAME,aAAa,GAAGD,WAAW,CAACE,gBAAZ,CAA8BL,OAA9B,CAAtB;AACA,UAAMM,QAAQ,GAAGF,aAAa,CAACG,KAAd,CACfC,OADe,CACN,GADM,EACD,QADC,EAEfA,OAFe,CAEN,KAFM,EAEC,MAFD,CAAjB;AAGA,UAAMC,QAAQ,GAAI,oBAAoBV,gBAAkB,EAAxD;AACA,UAAMW,IAAI,GAAI,qBAAqBJ,QAAU,EAA7C;AACA,UAAMK,KAAK,GAAI,GAAGF,QAAU,KAAKC,IAAM,GAAvC;AACA,UAAME,aAAa,GAAG,0BAAtB;AAEA,QAAIC,WAAW,GAAGX,aAAa,CAACY,cAAd,CAA8BF,aAA9B,CAAlB;;AAEA,QAAK,CAAEC,WAAP,EAAqB;AACpBA,MAAAA,WAAW,GAAGX,aAAa,CAACa,aAAd,CAA6B,OAA7B,CAAd;AACAF,MAAAA,WAAW,CAACG,EAAZ,GAAiBJ,aAAjB;AACAV,MAAAA,aAAa,CAACe,IAAd,CAAmBC,WAAnB,CAAgCL,WAAhC;AACA;;AAED,QAAKA,WAAW,CAACM,SAAZ,KAA0BR,KAA/B,EAAuC;AACtCE,MAAAA,WAAW,CAACM,SAAZ,GAAwBR,KAAxB;AACA;AACD,GApCD,EAoCG,CAAEf,aAAF,CApCH;AAqCA,SAAOD,GAAP;AACA","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useEffect, useRef } from '@wordpress/element';\n\n/*\n * Calculates and renders the format boundary style when the active formats\n * change.\n */\nexport function useBoundaryStyle( { record } ) {\n\tconst ref = useRef();\n\tconst { activeFormats = [] } = record.current;\n\tuseEffect( () => {\n\t\t// There's no need to recalculate the boundary styles if no formats are\n\t\t// active, because no boundary styles will be visible.\n\t\tif ( ! activeFormats || ! activeFormats.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst boundarySelector = '*[data-rich-text-format-boundary]';\n\t\tconst element = ref.current.querySelector( boundarySelector );\n\n\t\tif ( ! element ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { ownerDocument } = element;\n\t\tconst { defaultView } = ownerDocument;\n\t\tconst computedStyle = defaultView.getComputedStyle( element );\n\t\tconst newColor = computedStyle.color\n\t\t\t.replace( ')', ', 0.2)' )\n\t\t\t.replace( 'rgb', 'rgba' );\n\t\tconst selector = `.rich-text:focus ${ boundarySelector }`;\n\t\tconst rule = `background-color: ${ newColor }`;\n\t\tconst style = `${ selector } {${ rule }}`;\n\t\tconst globalStyleId = 'rich-text-boundary-style';\n\n\t\tlet globalStyle = ownerDocument.getElementById( globalStyleId );\n\n\t\tif ( ! globalStyle ) {\n\t\t\tglobalStyle = ownerDocument.createElement( 'style' );\n\t\t\tglobalStyle.id = globalStyleId;\n\t\t\townerDocument.head.appendChild( globalStyle );\n\t\t}\n\n\t\tif ( globalStyle.innerHTML !== style ) {\n\t\t\tglobalStyle.innerHTML = style;\n\t\t}\n\t}, [ activeFormats ] );\n\treturn ref;\n}\n"]}